<script>
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1y5ba3S5XMWB7aNIy5Z0EQ0UyXSvNEW5v6HWAz0X6L1y30gtBADGFuWMiOljHpOUp5jE-8Dy5WJp/pub?output=csv";

let data = [];

// Ambil data dari Google Sheets (CSV)
async function loadData() {
  const res = await fetch(SHEET_URL);
  const csvText = await res.text();
  const rows = csvText.split("\n").map(r => r.split(","));
  const headers = rows[0];
  data = rows.slice(1).map(row => {
    let obj = {};
    headers.forEach((h, i) => obj[h.trim()] = row[i]?.trim());
    return obj;
  });
  showFamilies();
}

// Tampilkan daftar Famili
function showFamilies() {
  const families = [...new Set(data.map(d => d.Famili))];
  const container = document.getElementById("content");
  container.innerHTML = `<h2>Pilih Famili</h2>`;
  families.forEach(fam => {
    const btn = document.createElement("button");
    btn.textContent = fam;
    btn.onclick = () => showGenus(fam);
    container.appendChild(btn);
  });
}

// Tampilkan daftar Genus dari Famili yang diklik
function showGenus(family) {
  const genera = [...new Set(data.filter(d => d.Famili === family).map(d => d.Genus))];
  const container = document.getElementById("content");
  container.innerHTML = `<h2>Famili: ${family}</h2>`;
  genera.forEach(gen => {
    const btn = document.createElement("button");
    btn.textContent = gen;
    btn.onclick = () => showSpecies(family, gen);
    container.appendChild(btn);
  });
}

// Tampilkan daftar Spesies
function showSpecies(family, genus) {
  const speciesList = data.filter(d => d.Famili === family && d.Genus === genus);
  const container = document.getElementById("content");
  container.innerHTML = `<h2>${family} ‚Üí ${genus}</h2>`;
  speciesList.forEach(sp => {
    const div = document.createElement("div");
    div.innerHTML = `
      <h3>${sp.Spesies}</h3>
      <p><strong>Nama Lokal:</strong> ${sp["Nama Lokal"] || "-"}</p>
      <p><strong>Status IUCN:</strong> ${sp["Status IUCN"] || "-"}</p>
      <p><strong>CITES:</strong> ${sp["CITES"] || "-"}</p>
      <p><strong>P.106:</strong> ${sp["P106"] || "-"}</p>
      <p><strong>Deskripsi:</strong> ${sp["Deskripsi"] || "-"}</p>
      <img src="${sp["Gambar"] || ""}" style="max-width:200px; border-radius:8px;">
      <p><a target="_blank" href="https://www.google.com/maps?q=${sp["Koordinat"]}">üìç Lihat Lokasi</a></p>
    `;
    container.appendChild(div);
  });
}

loadData();
</script>
